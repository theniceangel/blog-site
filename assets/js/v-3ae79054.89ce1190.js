(self.webpackChunkblog_site=self.webpackChunkblog_site||[]).push([[2934],{6872:(s,e,n)=>{"use strict";n.r(e),n.d(e,{data:()=>l});const l={key:"v-3ae79054",path:"/webpack4/third-dependencies/node-libs-browser.html",title:"node-libs-browser",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"原理",slug:"原理",children:[]}],filePathRelative:"webpack4/third-dependencies/node-libs-browser.md",git:{updatedTime:1628438767e3,contributors:[{name:"jizhi",email:"jizhi@didiglobal.com",commits:1}]}}},9738:(s,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>Ve});var l=n(6252);const t=(0,l.Wm)("h1",{id:"node-libs-browser",tabindex:"-1"},[(0,l.Wm)("a",{class:"header-anchor",href:"#node-libs-browser","aria-hidden":"true"},"#"),(0,l.Uk)(" node-libs-browser")],-1),a={href:"https://github.com/webpack/node-libs-browser",target:"_blank",rel:"noopener noreferrer"},o=(0,l.Uk)("node-libs-browser"),r=(0,l.Uk)(" 是 webpack 作者自己维护的一个库，为了在浏览器使用一些 node 核心模块。webpack v4.46.0 版本使用的是 2.2.1 版本的"),p=(0,l.Wm)("p",null,"node-libs-browser 导出来的对象拥有以下的属性来与 node core libs 接口对齐，其中一些模块还提供了 mock 的功能，仅仅只是为了拉齐 node core libs 的 API，mock 函数并没有什么功能，以下是整体的对照",-1),c=(0,l.Wm)("thead",null,[(0,l.Wm)("tr",null,[(0,l.Wm)("th",{style:{"text-align":"center"}},"lib name"),(0,l.Wm)("th",{style:{"text-align":"center"}},"browser implementation"),(0,l.Wm)("th",{style:{"text-align":"center"}},"mock implementation")])],-1),E=(0,l.Wm)("td",{style:{"text-align":"center"}},"assert",-1),y={style:{"text-align":"center"}},i={href:"https://github.com/defunctzombie/commonjs-assert",target:"_blank",rel:"noopener noreferrer"},m=(0,l.Uk)("defunctzombie/commonjs-assert"),F=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),u=(0,l.Wm)("td",{style:{"text-align":"center"}},"buffer",-1),b={style:{"text-align":"center"}},d={href:"https://github.com/feross/buffer",target:"_blank",rel:"noopener noreferrer"},g=(0,l.Uk)("feross/buffer"),W={style:{"text-align":"center"}},h={href:"https://github.com/webpack/node-libs-browser/blob/master/mock/buffer.js",target:"_blank",rel:"noopener noreferrer"},B=(0,l.Uk)("buffer.js"),f=(0,l.Wm)("tr",null,[(0,l.Wm)("td",{style:{"text-align":"center"}},"child_process"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---")],-1),x=(0,l.Wm)("tr",null,[(0,l.Wm)("td",{style:{"text-align":"center"}},"cluster"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---")],-1),q=(0,l.Wm)("td",{style:{"text-align":"center"}},"console",-1),k={style:{"text-align":"center"}},w={href:"https://github.com/Raynos/console-browserify",target:"_blank",rel:"noopener noreferrer"},v=(0,l.Uk)("Raynos/console-browserify"),j={style:{"text-align":"center"}},C={href:"https://github.com/webpack/node-libs-browser/blob/master/mock/console.js",target:"_blank",rel:"noopener noreferrer"},_=(0,l.Uk)("console.js"),U=(0,l.Wm)("td",{style:{"text-align":"center"}},"constants",-1),z={style:{"text-align":"center"}},P={href:"https://github.com/juliangruber/constants-browserify",target:"_blank",rel:"noopener noreferrer"},R=(0,l.Uk)("juliangruber/constants-browserify"),A=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),G=(0,l.Wm)("td",{style:{"text-align":"center"}},"crypto",-1),N={style:{"text-align":"center"}},D={href:"https://github.com/crypto-browserify/crypto-browserify",target:"_blank",rel:"noopener noreferrer"},H=(0,l.Uk)("crypto-browserify/crypto-browserify"),I=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),L=(0,l.Wm)("tr",null,[(0,l.Wm)("td",{style:{"text-align":"center"}},"dgram"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---")],-1),O=(0,l.Wm)("td",{style:{"text-align":"center"}},"dns",-1),S=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),T={style:{"text-align":"center"}},Y={href:"https://github.com/webpack/node-libs-browser/blob/master/mock/dns.js",target:"_blank",rel:"noopener noreferrer"},J=(0,l.Uk)("dns.js"),K=(0,l.Wm)("td",{style:{"text-align":"center"}},"domain",-1),M={style:{"text-align":"center"}},Q={href:"https://github.com/bevry/domain-browser",target:"_blank",rel:"noopener noreferrer"},V=(0,l.Uk)("bevry/domain-browser"),X=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),Z=(0,l.Wm)("td",{style:{"text-align":"center"}},"events",-1),$={style:{"text-align":"center"}},ss={href:"https://github.com/Gozala/events",target:"_blank",rel:"noopener noreferrer"},es=(0,l.Uk)("Gozala/events"),ns=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),ls=(0,l.Wm)("tr",null,[(0,l.Wm)("td",{style:{"text-align":"center"}},"fs"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---")],-1),ts=(0,l.Wm)("td",{style:{"text-align":"center"}},"http",-1),as={style:{"text-align":"center"}},os={href:"https://github.com/jhiesey/stream-http",target:"_blank",rel:"noopener noreferrer"},rs=(0,l.Uk)("jhiesey/stream-http"),ps=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),cs=(0,l.Wm)("td",{style:{"text-align":"center"}},"https",-1),Es={style:{"text-align":"center"}},ys={href:"https://github.com/substack/https-browserify",target:"_blank",rel:"noopener noreferrer"},is=(0,l.Uk)("substack/https-browserify"),ms=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),Fs=(0,l.Wm)("tr",null,[(0,l.Wm)("td",{style:{"text-align":"center"}},"module"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---")],-1),us=(0,l.Wm)("td",{style:{"text-align":"center"}},"net",-1),bs=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),ds={style:{"text-align":"center"}},gs={href:"https://github.com/webpack/node-libs-browser/blob/master/mock/net.js",target:"_blank",rel:"noopener noreferrer"},Ws=(0,l.Uk)("net.js"),hs=(0,l.Wm)("td",{style:{"text-align":"center"}},"os",-1),Bs={style:{"text-align":"center"}},fs={href:"https://github.com/CoderPuppy/os-browserify",target:"_blank",rel:"noopener noreferrer"},xs=(0,l.Uk)("CoderPuppy/os-browserify"),qs=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),ks=(0,l.Wm)("td",{style:{"text-align":"center"}},"path",-1),ws={style:{"text-align":"center"}},vs={href:"https://github.com/substack/path-browserify",target:"_blank",rel:"noopener noreferrer"},js=(0,l.Uk)("substack/path-browserify"),Cs=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),_s=(0,l.Wm)("td",{style:{"text-align":"center"}},"process",-1),Us={style:{"text-align":"center"}},zs={href:"https://github.com/shtylman/node-process",target:"_blank",rel:"noopener noreferrer"},Ps=(0,l.Uk)("shtylman/node-process"),Rs={style:{"text-align":"center"}},As={href:"https://github.com/webpack/node-libs-browser/blob/master/mock/process.js",target:"_blank",rel:"noopener noreferrer"},Gs=(0,l.Uk)("process.js"),Ns=(0,l.Wm)("td",{style:{"text-align":"center"}},"punycode",-1),Ds={style:{"text-align":"center"}},Hs={href:"https://github.com/bestiejs/punycode.js",target:"_blank",rel:"noopener noreferrer"},Is=(0,l.Uk)("bestiejs/punycode.js"),Ls={style:{"text-align":"center"}},Os={href:"https://github.com/webpack/node-libs-browser/blob/master/mock/punycode.js",target:"_blank",rel:"noopener noreferrer"},Ss=(0,l.Uk)("punycode.js"),Ts=(0,l.Wm)("td",{style:{"text-align":"center"}},"querystring",-1),Ys={style:{"text-align":"center"}},Js={href:"https://github.com/mike-spainhower/querystring",target:"_blank",rel:"noopener noreferrer"},Ks=(0,l.Uk)("mike-spainhower/querystring"),Ms=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),Qs=(0,l.Wm)("tr",null,[(0,l.Wm)("td",{style:{"text-align":"center"}},"readline"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---")],-1),Vs=(0,l.Wm)("tr",null,[(0,l.Wm)("td",{style:{"text-align":"center"}},"repl"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---"),(0,l.Wm)("td",{style:{"text-align":"center"}},"---")],-1),Xs=(0,l.Wm)("td",{style:{"text-align":"center"}},"stream",-1),Zs={style:{"text-align":"center"}},$s={href:"https://github.com/substack/stream-browserify",target:"_blank",rel:"noopener noreferrer"},se=(0,l.Uk)("substack/stream-browserify"),ee=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),ne=(0,l.Wm)("td",{style:{"text-align":"center"}},"string_decoder",-1),le={style:{"text-align":"center"}},te={href:"https://github.com/rvagg/string_decoder",target:"_blank",rel:"noopener noreferrer"},ae=(0,l.Uk)("rvagg/string_decoder"),oe=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),re=(0,l.Wm)("td",{style:{"text-align":"center"}},"sys",-1),pe={style:{"text-align":"center"}},ce={href:"https://github.com/defunctzombie/node-util",target:"_blank",rel:"noopener noreferrer"},Ee=(0,l.Uk)("defunctzombie/node-util"),ye=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),ie=(0,l.Wm)("td",{style:{"text-align":"center"}},"timers",-1),me={style:{"text-align":"center"}},Fe={href:"https://github.com/jryans/timers-browserify",target:"_blank",rel:"noopener noreferrer"},ue=(0,l.Uk)("jryans/timers-browserify"),be=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),de=(0,l.Wm)("td",{style:{"text-align":"center"}},"tls",-1),ge=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),We={style:{"text-align":"center"}},he={href:"https://github.com/webpack/node-libs-browser/blob/master/mock/tls.js",target:"_blank",rel:"noopener noreferrer"},Be=(0,l.Uk)("tls.js"),fe=(0,l.Wm)("td",{style:{"text-align":"center"}},"tty",-1),xe={style:{"text-align":"center"}},qe={href:"https://github.com/substack/tty-browserify",target:"_blank",rel:"noopener noreferrer"},ke=(0,l.Uk)("substack/tty-browserify"),we={style:{"text-align":"center"}},ve={href:"https://github.com/webpack/node-libs-browser/blob/master/mock/tty.js",target:"_blank",rel:"noopener noreferrer"},je=(0,l.Uk)("tty.js"),Ce=(0,l.Wm)("td",{style:{"text-align":"center"}},"url",-1),_e={style:{"text-align":"center"}},Ue={href:"https://github.com/defunctzombie/node-url",target:"_blank",rel:"noopener noreferrer"},ze=(0,l.Uk)("defunctzombie/node-url"),Pe=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),Re=(0,l.Wm)("td",{style:{"text-align":"center"}},"util",-1),Ae={style:{"text-align":"center"}},Ge={href:"https://github.com/defunctzombie/node-util",target:"_blank",rel:"noopener noreferrer"},Ne=(0,l.Uk)("defunctzombie/node-util"),De=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),He=(0,l.Wm)("td",{style:{"text-align":"center"}},"vm",-1),Ie={style:{"text-align":"center"}},Le={href:"https://github.com/substack/vm-browserify",target:"_blank",rel:"noopener noreferrer"},Oe=(0,l.Uk)("substack/vm-browserify"),Se=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),Te=(0,l.Wm)("td",{style:{"text-align":"center"}},"zlib",-1),Ye={style:{"text-align":"center"}},Je={href:"https://github.com/devongovett/browserify-zlib",target:"_blank",rel:"noopener noreferrer"},Ke=(0,l.Uk)("devongovett/browserify-zlib"),Me=(0,l.Wm)("td",{style:{"text-align":"center"}},"---",-1),Qe=(0,l.uE)('<h2 id="原理" tabindex="-1"><a class="header-anchor" href="#原理" aria-hidden="true">#</a> 原理</h2><p>node-libs-browser 模块只是暴露了其他浏览器侧模块的路径，并没有实际引用这些模块。来看它的 <code>index.js</code></p><details class="custom-container details"><summary>index.js</summary><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#24292e;"><code><span class="line"><span style="color:#6A737D;">// 通过 require.resolve 得到的就是对应模块的绝对路径</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.assert </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;assert/&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.buffer </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;buffer/&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.child_process\t</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.cluster </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.console </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;console-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.constants </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;constants-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.crypto </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;crypto-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.dgram </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.dns </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.domain </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;domain-browser&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.events </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;events/&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.fs </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.http </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;stream-http&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.https\t</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;https-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.module </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.net </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.os </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;os-browserify/browser.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.path </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;path-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.punycode </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;punycode/&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.process </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;process/browser.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.querystring </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;querystring-es3/&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.readline </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.repl </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.stream </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;stream-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">._stream_duplex </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;readable-stream/duplex.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">._stream_passthrough </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;readable-stream/passthrough.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">._stream_readable </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;readable-stream/readable.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">._stream_transform </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;readable-stream/transform.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">._stream_writable </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;readable-stream/writable.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.string_decoder </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;string_decoder/&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.sys </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;util/util.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.timers </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;timers-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.tls </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.tty </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;tty-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.url </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;url/&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.util </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;util/util.js&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.vm </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;vm-browserify&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"><span style="color:#79B8FF;">exports</span><span style="color:#E1E4E8;">.zlib </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> require.</span><span style="color:#B392F0;">resolve</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;browserify-zlib&#39;</span><span style="color:#E1E4E8;">);</span></span>\n<span class="line"></span></code></pre></div></details><p>可以看到暴露出去的都是对应 browser 实现的模块的路径，node-libs-browser 通过 package.json 来确保这些依赖被安装。</p><details class="custom-container details"><summary>package.json</summary><div class="language-json ext-json"><pre class="shiki" style="background-color:#24292e;"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">&quot;dependencies&quot;</span><span style="color:#E1E4E8;">: {</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;assert&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^1.1.1&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;browserify-zlib&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^0.2.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;buffer&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^4.3.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;console-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^1.1.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;constants-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^1.0.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;crypto-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^3.11.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;domain-browser&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^1.1.1&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;events&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^3.0.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;https-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^1.0.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;os-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^0.3.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;path-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;0.0.1&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;process&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^0.11.10&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;punycode&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^1.2.4&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;querystring-es3&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^0.2.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;readable-stream&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^2.3.3&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;stream-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^2.0.1&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;stream-http&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^2.7.2&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;string_decoder&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^1.0.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;timers-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^2.0.4&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;tty-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;0.0.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;url&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^0.11.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;util&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^0.11.0&quot;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">&quot;vm-browserify&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;^1.0.1&quot;</span></span>\n<span class="line"><span style="color:#E1E4E8;">  }</span></span>\n<span class="line"><span style="color:#E1E4E8;">}</span></span>\n<span class="line"></span></code></pre></div></details><p>node-libs-browser 也提供了一些模块的 mock。他们都在 mock 目录下面。</p><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#24292e;"><code><span class="line"><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">mock</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> buffer.js</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> console.js</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> dns.js</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> empty.js</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> net.js</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> process.js</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> punycode.js</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> tls.js</span></span>\n<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|--</span><span style="color:#E1E4E8;"> tty.js</span></span>\n<span class="line"></span></code></pre></div><p>\b这些 mock 模块也会被 webpack 的 NodeSourcePlugin 插件引用。</p>',8),Ve={render:function(s,e){const n=(0,l.up)("OutboundLink");return(0,l.wg)(),(0,l.j4)(l.HY,null,[t,(0,l.Wm)("p",null,[(0,l.Wm)("a",a,[o,(0,l.Wm)(n)]),r]),p,(0,l.Wm)("table",null,[c,(0,l.Wm)("tbody",null,[(0,l.Wm)("tr",null,[E,(0,l.Wm)("td",y,[(0,l.Wm)("a",i,[m,(0,l.Wm)(n)])]),F]),(0,l.Wm)("tr",null,[u,(0,l.Wm)("td",b,[(0,l.Wm)("a",d,[g,(0,l.Wm)(n)])]),(0,l.Wm)("td",W,[(0,l.Wm)("a",h,[B,(0,l.Wm)(n)])])]),f,x,(0,l.Wm)("tr",null,[q,(0,l.Wm)("td",k,[(0,l.Wm)("a",w,[v,(0,l.Wm)(n)])]),(0,l.Wm)("td",j,[(0,l.Wm)("a",C,[_,(0,l.Wm)(n)])])]),(0,l.Wm)("tr",null,[U,(0,l.Wm)("td",z,[(0,l.Wm)("a",P,[R,(0,l.Wm)(n)])]),A]),(0,l.Wm)("tr",null,[G,(0,l.Wm)("td",N,[(0,l.Wm)("a",D,[H,(0,l.Wm)(n)])]),I]),L,(0,l.Wm)("tr",null,[O,S,(0,l.Wm)("td",T,[(0,l.Wm)("a",Y,[J,(0,l.Wm)(n)])])]),(0,l.Wm)("tr",null,[K,(0,l.Wm)("td",M,[(0,l.Wm)("a",Q,[V,(0,l.Wm)(n)])]),X]),(0,l.Wm)("tr",null,[Z,(0,l.Wm)("td",$,[(0,l.Wm)("a",ss,[es,(0,l.Wm)(n)])]),ns]),ls,(0,l.Wm)("tr",null,[ts,(0,l.Wm)("td",as,[(0,l.Wm)("a",os,[rs,(0,l.Wm)(n)])]),ps]),(0,l.Wm)("tr",null,[cs,(0,l.Wm)("td",Es,[(0,l.Wm)("a",ys,[is,(0,l.Wm)(n)])]),ms]),Fs,(0,l.Wm)("tr",null,[us,bs,(0,l.Wm)("td",ds,[(0,l.Wm)("a",gs,[Ws,(0,l.Wm)(n)])])]),(0,l.Wm)("tr",null,[hs,(0,l.Wm)("td",Bs,[(0,l.Wm)("a",fs,[xs,(0,l.Wm)(n)])]),qs]),(0,l.Wm)("tr",null,[ks,(0,l.Wm)("td",ws,[(0,l.Wm)("a",vs,[js,(0,l.Wm)(n)])]),Cs]),(0,l.Wm)("tr",null,[_s,(0,l.Wm)("td",Us,[(0,l.Wm)("a",zs,[Ps,(0,l.Wm)(n)])]),(0,l.Wm)("td",Rs,[(0,l.Wm)("a",As,[Gs,(0,l.Wm)(n)])])]),(0,l.Wm)("tr",null,[Ns,(0,l.Wm)("td",Ds,[(0,l.Wm)("a",Hs,[Is,(0,l.Wm)(n)])]),(0,l.Wm)("td",Ls,[(0,l.Wm)("a",Os,[Ss,(0,l.Wm)(n)])])]),(0,l.Wm)("tr",null,[Ts,(0,l.Wm)("td",Ys,[(0,l.Wm)("a",Js,[Ks,(0,l.Wm)(n)])]),Ms]),Qs,Vs,(0,l.Wm)("tr",null,[Xs,(0,l.Wm)("td",Zs,[(0,l.Wm)("a",$s,[se,(0,l.Wm)(n)])]),ee]),(0,l.Wm)("tr",null,[ne,(0,l.Wm)("td",le,[(0,l.Wm)("a",te,[ae,(0,l.Wm)(n)])]),oe]),(0,l.Wm)("tr",null,[re,(0,l.Wm)("td",pe,[(0,l.Wm)("a",ce,[Ee,(0,l.Wm)(n)])]),ye]),(0,l.Wm)("tr",null,[ie,(0,l.Wm)("td",me,[(0,l.Wm)("a",Fe,[ue,(0,l.Wm)(n)])]),be]),(0,l.Wm)("tr",null,[de,ge,(0,l.Wm)("td",We,[(0,l.Wm)("a",he,[Be,(0,l.Wm)(n)])])]),(0,l.Wm)("tr",null,[fe,(0,l.Wm)("td",xe,[(0,l.Wm)("a",qe,[ke,(0,l.Wm)(n)])]),(0,l.Wm)("td",we,[(0,l.Wm)("a",ve,[je,(0,l.Wm)(n)])])]),(0,l.Wm)("tr",null,[Ce,(0,l.Wm)("td",_e,[(0,l.Wm)("a",Ue,[ze,(0,l.Wm)(n)])]),Pe]),(0,l.Wm)("tr",null,[Re,(0,l.Wm)("td",Ae,[(0,l.Wm)("a",Ge,[Ne,(0,l.Wm)(n)])]),De]),(0,l.Wm)("tr",null,[He,(0,l.Wm)("td",Ie,[(0,l.Wm)("a",Le,[Oe,(0,l.Wm)(n)])]),Se]),(0,l.Wm)("tr",null,[Te,(0,l.Wm)("td",Ye,[(0,l.Wm)("a",Je,[Ke,(0,l.Wm)(n)])]),Me])])]),Qe],64)}}}}]);