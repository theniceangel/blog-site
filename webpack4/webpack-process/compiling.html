<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <title>编译进行时 | 卑鄙智</title><meta name="description" content=""><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.22">
    <link rel="preload" href="/blog-site/assets/js/runtime~app.b8391e89.js" as="script"><link rel="preload" href="/blog-site/assets/css/styles.ec008df3.css" as="style"><link rel="preload" href="/blog-site/assets/js/4640.d13a5239.js" as="script"><link rel="preload" href="/blog-site/assets/js/app.20f347e0.js" as="script">
    <link rel="stylesheet" href="/blog-site/assets/css/styles.ec008df3.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/blog-site/" class=""><img class="logo" src="/blog-site/assets/logo.jpeg" alt="卑鄙智"><span class="site-name can-hide">卑鄙智</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Vue 源码合集"><span class="title">Vue 源码合集</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Vue 源码合集"><span class="title">Vue 源码合集</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog-site/vue2/README.md" class="nav-link" aria-label="v2"><!--[--><!--]--> v2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog-site/vue3/README.md" class="nav-link" aria-label="v3"><!--[--><!--]--> v3 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="webpack 源码合集"><span class="title">webpack 源码合集</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="webpack 源码合集"><span class="title">webpack 源码合集</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog-site/webpack4/README.md" class="nav-link" aria-label="v4.46.0"><!--[--><!--]--> v4.46.0 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog-site/webpack5/README.md" class="nav-link" aria-label="v5"><!--[--><!--]--> v5 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="计算机基础知识"><span class="title">计算机基础知识</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="计算机基础知识"><span class="title">计算机基础知识</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog-site/networks/README.md" class="nav-link" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog-site/nginx/README.md" class="nav-link" aria-label="nginx"><!--[--><!--]--> nginx <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/theniceangel" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Vue 源码合集"><span class="title">Vue 源码合集</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Vue 源码合集"><span class="title">Vue 源码合集</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog-site/vue2/README.md" class="nav-link" aria-label="v2"><!--[--><!--]--> v2 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog-site/vue3/README.md" class="nav-link" aria-label="v3"><!--[--><!--]--> v3 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="webpack 源码合集"><span class="title">webpack 源码合集</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="webpack 源码合集"><span class="title">webpack 源码合集</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog-site/webpack4/README.md" class="nav-link" aria-label="v4.46.0"><!--[--><!--]--> v4.46.0 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog-site/webpack5/README.md" class="nav-link" aria-label="v5"><!--[--><!--]--> v5 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="计算机基础知识"><span class="title">计算机基础知识</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="计算机基础知识"><span class="title">计算机基础知识</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/blog-site/networks/README.md" class="nav-link" aria-label="网络"><!--[--><!--]--> 网络 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/blog-site/nginx/README.md" class="nav-link" aria-label="nginx"><!--[--><!--]--> nginx <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/theniceangel" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">术语</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/term/module.html" class="nav-link sidebar-item" aria-label="module"><!--[--><!--]--> module <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/term/chunk.html" class="nav-link sidebar-item" aria-label="chunk"><!--[--><!--]--> chunk <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/term/entrypoint&amp;chunkGroup.html" class="nav-link sidebar-item" aria-label="chunkGroup、entrypoint"><!--[--><!--]--> chunkGroup、entrypoint <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/term/dependency&amp;moduleFactory.html" class="nav-link sidebar-item" aria-label="dependency、moduleFactory"><!--[--><!--]--> dependency、moduleFactory <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">tapable</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/tapable" class="nav-link sidebar-item" aria-label="Tapable"><!--[--><!--]--> Tapable <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">流程图</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/introduction/flow-diagram.html" class="nav-link sidebar-item" aria-label="webpack 流程图"><!--[--><!--]--> webpack 流程图 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item active">编译全流程</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/webpack-process/startup.html" class="nav-link sidebar-item" aria-label="准备工作"><!--[--><!--]--> 准备工作 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/webpack-process/handle-options.html" class="nav-link sidebar-item" aria-label="处理 options"><!--[--><!--]--> 处理 options <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/webpack-process/new-compiler.html" class="nav-link sidebar-item" aria-label="处理 compiler"><!--[--><!--]--> 处理 compiler <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/webpack-process/inner-plugins.html" class="nav-link sidebar-item" aria-label="处理 innerPlugins"><!--[--><!--]--> 处理 innerPlugins <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/webpack-process/run-compiler.html" class="nav-link sidebar-item" aria-label="运行 compiler"><!--[--><!--]--> 运行 compiler <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/webpack-process/before-compile.html" class="nav-link sidebar-item" aria-label="编译之前"><!--[--><!--]--> 编译之前 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog-site/webpack4/webpack-process/compiling.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="编译进行时"><!--[--><!--]--> 编译进行时 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/blog-site/webpack4/webpack-process/compiling.html#compiler-compile-oncompiled" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="compiler.compile(onCompiled)"><!--[--><!--]--> compiler.compile(onCompiled) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog-site/webpack4/webpack-process/compiling.html#this-newcompilationparams" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="this.newCompilationParams()"><!--[--><!--]--> this.newCompilationParams() <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog-site/webpack4/webpack-process/compiling.html#beforecompile-hook-与-compile-hook" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="beforeCompile hook 与 compile hook"><!--[--><!--]--> beforeCompile hook 与 compile hook <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/blog-site/webpack4/webpack-process/compiling.html#this-newcompilation-params" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="this.newCompilation(params)"><!--[--><!--]--> this.newCompilation(params) <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/blog-site/webpack4/webpack-process/compiling-modules.html" class="nav-link sidebar-item" aria-label="模块解析"><!--[--><!--]--> 模块解析 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">路径解析</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/module-resolver/" class="nav-link sidebar-item" aria-label="引言"><!--[--><!--]--> 引言 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/module-resolver/Resolver.html" class="nav-link sidebar-item" aria-label="Resolver"><!--[--><!--]--> Resolver <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/module-resolver/ResolverFactory.html" class="nav-link sidebar-item" aria-label="ResolverFactory"><!--[--><!--]--> ResolverFactory <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Loader 原理</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/loaders/" class="nav-link sidebar-item" aria-label="Loaders"><!--[--><!--]--> Loaders <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/loaders/loader-runner.html" class="nav-link sidebar-item" aria-label="loader-runner"><!--[--><!--]--> loader-runner <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">webpack 内部插件合集</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/internal-plugins/entry/EntryOptionPlugin.html" class="nav-link sidebar-item" aria-label="EntryOptionPlugin"><!--[--><!--]--> EntryOptionPlugin <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/internal-plugins/TemplatedPathPlugin.html" class="nav-link sidebar-item" aria-label="TemplatedPathPlugin"><!--[--><!--]--> TemplatedPathPlugin <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/blog-site/webpack4/internal-plugins/WarnCaseSensitiveModulesPlugin.html" class="nav-link sidebar-item" aria-label="WarnCaseSensitiveModulesPlugin"><!--[--><!--]--> WarnCaseSensitiveModulesPlugin <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">webpack 第三方库</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/third-dependencies/" class="nav-link sidebar-item" aria-label="总览"><!--[--><!--]--> 总览 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">webpack 配置项</p><ul class=""><li><!--[--><a href="/blog-site/webpack4/configuration/" class="nav-link sidebar-item" aria-label="Configuration"><!--[--><!--]--> Configuration <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="编译进行时" tabindex="-1"><a class="header-anchor" href="#编译进行时" aria-hidden="true">#</a> 编译进行时</h1><h2 id="compiler-compile-oncompiled" tabindex="-1"><a class="header-anchor" href="#compiler-compile-oncompiled" aria-hidden="true">#</a> compiler.compile(onCompiled)</h2><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#24292e;"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Compiler</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Tapable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">compile</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">callback</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 第一步</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">params</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">newCompilationParams</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 第二步</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.hooks.beforeCompile.</span><span style="color:#B392F0;">callAsync</span><span style="color:#E1E4E8;">(params, </span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (err) </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">callback</span><span style="color:#E1E4E8;">(err);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.hooks.compile.</span><span style="color:#B392F0;">call</span><span style="color:#E1E4E8;">(params);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// 第三步</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">compilation</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">newCompilation</span><span style="color:#E1E4E8;">(params);</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">// 第四步</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.hooks.make.</span><span style="color:#B392F0;">callAsync</span><span style="color:#E1E4E8;">(compilation, </span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (err) </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">callback</span><span style="color:#E1E4E8;">(err);</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">// 第五步：TODO</span></span>
<span class="line"><span style="color:#E1E4E8;">        compilation.</span><span style="color:#B392F0;">finish</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (err) </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">callback</span><span style="color:#E1E4E8;">(err);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">          compilation.</span><span style="color:#B392F0;">seal</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (err) </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">callback</span><span style="color:#E1E4E8;">(err);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.hooks.afterCompile.</span><span style="color:#B392F0;">callAsync</span><span style="color:#E1E4E8;">(compilation, </span><span style="color:#FFAB70;">err</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=&gt;</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (err) </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">callback</span><span style="color:#E1E4E8;">(err);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">callback</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">null</span><span style="color:#E1E4E8;">, compilation);</span></span>
<span class="line"><span style="color:#E1E4E8;">            });</span></span>
<span class="line"><span style="color:#E1E4E8;">          });</span></span>
<span class="line"><span style="color:#E1E4E8;">        });</span></span>
<span class="line"><span style="color:#E1E4E8;">      });</span></span>
<span class="line"><span style="color:#E1E4E8;">    });</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span></code></pre></div><p>第一步调用 <code>this.newCompilationParams</code> 生成 normalModuleFactory、contextModuleFactory 实例。</p><h2 id="this-newcompilationparams" tabindex="-1"><a class="header-anchor" href="#this-newcompilationparams" aria-hidden="true">#</a> this.newCompilationParams()</h2><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#24292e;"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Compiler</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Tapable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">newCompilationParams</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">params</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">      normalModuleFactory: </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">createNormalModuleFactory</span><span style="color:#E1E4E8;">(),</span></span>
<span class="line"><span style="color:#E1E4E8;">      contextModuleFactory: </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">createContextModuleFactory</span><span style="color:#E1E4E8;">(),</span></span>
<span class="line"><span style="color:#E1E4E8;">      compilationDependencies: </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Set</span><span style="color:#E1E4E8;">() </span><span style="color:#6A737D;">// TODO</span></span>
<span class="line"><span style="color:#E1E4E8;">    };</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> params;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span></code></pre></div><ul><li><p><strong><code>createNormalModuleFactory</code></strong></p><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#24292e;"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Compiler</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Tapable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">createNormalModuleFactory</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">normalModuleFactory</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">NormalModuleFactory</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.options.context, </span><span style="color:#6A737D;">// 运行 webpack 构建的上下文路径</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.resolverFactory, </span><span style="color:#6A737D;">// ResolverFactory 实例</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.options.module </span><span style="color:#F97583;">||</span><span style="color:#E1E4E8;"> {} </span><span style="color:#6A737D;">// webpack 关于 module 的配置</span></span>
<span class="line"><span style="color:#E1E4E8;">    );</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 触发 normalModuleFactory hook</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.hooks.normalModuleFactory.</span><span style="color:#B392F0;">call</span><span style="color:#E1E4E8;">(normalModuleFactory);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> normalModuleFactory;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span></code></pre></div><p>normalModuleFactory 在 webpack 的一次构建中扮演着特别重要的角色，它是一个工厂实例，作用是为了生成 normalModule，在 webpack 的生态里面，绝大部分的模块都是 normalModule。</p></li><li><p><strong><code>createContextModuleFactory</code></strong></p><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#24292e;"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Compiler</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Tapable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">createContextModuleFactory</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">contextModuleFactory</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ContextModuleFactory</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.resolverFactory);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 触发 contextModuleFactory hook</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.hooks.contextModuleFactory.</span><span style="color:#B392F0;">call</span><span style="color:#E1E4E8;">(contextModuleFactory);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> contextModuleFactory;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span></code></pre></div><p>contextModuleFactory 在 webpack 的一次构建中扮演着特别重要的角色，它是一个工厂函数，生成的 module 都是 contextModule。</p><p>// TODO ContextModule 的详解。</p></li></ul><p>第一步生成的 params 在后面生成 compilation 的时候会用到，第二步执行 beforeCompile 与 compile hook。</p><h2 id="beforecompile-hook-与-compile-hook" tabindex="-1"><a class="header-anchor" href="#beforecompile-hook-与-compile-hook" aria-hidden="true">#</a> beforeCompile hook 与 compile hook</h2><p>beforeCompile hook 是 AsyncSeriesHook 类型。暂未发现有插件钩入这个 hook，这个 hook 的入参就是第一步生成的 <code>params</code>。</p><p>compile hook 是 SyncHook 类型。暂未发现有插件钩入这个 hook，这个 hook 的入参也是第一步生成的 <code>params</code>。</p><p>接着就是第三步——<strong>生成 compilation</strong>。</p><h2 id="this-newcompilation-params" tabindex="-1"><a class="header-anchor" href="#this-newcompilation-params" aria-hidden="true">#</a> this.newCompilation(params)</h2><div class="language-javascript ext-js"><pre class="shiki" style="background-color:#24292e;"><code><span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Compiler</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">extends</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Tapable</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">createCompilation</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Compilation</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">newCompilation</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">params</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 生成 compilation</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">const</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">compilation</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">createCompilation</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 文件的时间戳</span></span>
<span class="line"><span style="color:#E1E4E8;">    compilation.fileTimestamps </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.fileTimestamps;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// TODO</span></span>
<span class="line"><span style="color:#E1E4E8;">    compilation.contextTimestamps </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.contextTimestamps;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// compiler 的名称</span></span>
<span class="line"><span style="color:#E1E4E8;">    compilation.name </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.name;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 将 compiler的 records 赋值给 compilation</span></span>
<span class="line"><span style="color:#E1E4E8;">    compilation.records </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.records;</span></span>
<span class="line"><span style="color:#E1E4E8;">    compilation.compilationDependencies </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> params.compilationDependencies;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 触发 thisCompilation hook</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.hooks.thisCompilation.</span><span style="color:#B392F0;">call</span><span style="color:#E1E4E8;">(compilation, params);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">// 触发 compilation hook</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">.hooks.compilation.</span><span style="color:#B392F0;">call</span><span style="color:#E1E4E8;">(compilation, params);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> compilation;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span></code></pre></div><p><strong>compilation 代表一次构建，而 compiler 可以通过接口多次调用 compile 来生成多个 compilation 实例，在 watch 模式下，每次修改文件都会重复构建。</strong></p><ul><li><strong><code>1. hooks.thisCompilation</code></strong></li></ul><p>钩入这个 hook 的插件有 <a href="/blog-site/webpack4/internal-plugins/jsonpChunkTemplate/JsonpTemplatePlugin.html" class="">JsonpTemplatePlugin</a>，FetchCompileWasmTemplatePlugin(略过)，<a href="/blog-site/webpack4/configuration/mode.html" class="">WarnNoModeSetPlugin</a>，<a href="/blog-site/webpack4/configuration/optimization/splitChunks.html" class="">SplitChunksPlugin</a></p><ul><li><p><strong><code>2. hooks.compilation</code></strong></p><p>钩入这个 hook 的插件非常非常多。下面娓娓道来。</p><ul><li><p><strong>FunctionModulePlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/FunctionModulePlugin.html" class="">FunctionModulePlugin</a></p></li><li><p><strong>LoaderTargetPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/LoaderTargetPlugin.html" class="">LoaderTargetPlugin</a></p></li><li><p><strong>JavascriptModulesPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/JavascriptModulesPlugin.html" class="">JavascriptModulesPlugin</a></p></li><li><p><strong>JsonModulesPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/JsonModulesPlugin.html" class="">JsonModulesPlugin</a></p></li><li><p><strong>WebAssemblyModulesPlugin</strong></p><p>略过。</p></li><li><p><strong>SingleEntryPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/entry/SingleEntryPlugin.html" class="">SingleEntryPlugin</a></p></li><li><p><strong>CompatibilityPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/CompatibilityPlugin.html" class="">CompatibilityPlugin</a></p></li><li><p><strong>HarmonyModulesPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/HarmonyModulesPlugin.html" class="">HarmonyModulesPlugin</a></p></li><li><p><strong>AMDPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/AMDPlugin.html" class="">AMDPlugin</a></p></li><li><p><strong>RequireJsStuffPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/RequireJsStuffPlugin.html" class="">RequireJsStuffPlugin</a></p></li><li><p><strong>CommonJsPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/CommonJsPlugin.html" class="">CommonJsPlugin</a></p></li><li><p><strong>LoaderPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/LoaderPlugin.html" class="">LoaderPlugin</a></p></li><li><p><strong>CommonJsStuffPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/CommonJsStuffPlugin.html" class="">CommonJsStuffPlugin</a></p></li><li><p><strong>APIPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/APIPlugin.html" class="">APIPlugin</a></p></li><li><p><strong>ConstPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/ConstPlugin.html" class="">ConstPlugin</a></p></li><li><p><strong>UseStrictPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/UseStrictPlugin.html" class="">UseStrictPlugin</a></p></li><li><p><strong>RequireIncludePlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/RequireIncludePlugin.html" class="">RequireIncludePlugin</a></p></li><li><p><strong>RequireEnsurePlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/RequireEnsurePlugin.html" class="">RequireEnsurePlugin</a></p></li><li><p><strong>RequireContextPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/RequireContextPlugin.html" class="">RequireContextPlugin</a></p></li><li><p><strong>ImportPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/ImportPlugin.html" class="">ImportPlugin</a></p></li><li><p><strong>SystemPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/SystemPlugin.html" class="">SystemPlugin</a></p></li><li><p><strong>EnsureChunkConditionsPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/EnsureChunkConditionsPlugin.html" class="">EnsureChunkConditionsPlugin</a></p></li><li><p><strong>RemoveParentModulesPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/configuration/optimization/removeAvailableModules.html" class="">RemoveParentModulesPlugin</a></p></li><li><p><strong>RemoveEmptyChunksPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/configuration/optimization/removeEmptyChunks.html" class="">RemoveEmptyChunksPlugin</a></p></li><li><p><strong>MergeDuplicateChunksPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/configuration/optimization/mergeDuplicateChunks.html" class="">MergeDuplicateChunksPlugin</a></p></li><li><p><strong>FlagIncludedChunksPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/configuration/optimization/flagIncludedChunks.html" class="">FlagIncludedChunksPlugin</a></p></li><li><p><strong>SideEffectsFlagPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/SideEffectsFlagPlugin.html" class="">SideEffectsFlagPlugin</a></p></li><li><p><strong>FlagDependencyExportsPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/FlagDependencyExportsPlugin.html" class="">FlagDependencyExportsPlugin</a></p></li><li><p><strong>FlagDependencyUsagePlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/FlagDependencyUsagePlugin.html" class="">FlagDependencyUsagePlugin</a></p></li><li><p><strong>ModuleConcatenationPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/ModuleConcatenationPlugin.html" class="">ModuleConcatenationPlugin</a></p></li><li><p><strong>NoEmitOnErrorsPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/configuration/optimization/noEmitOnErrors.html" class="">NoEmitOnErrorsPlugin</a></p></li><li><p><strong>WasmFinalizeExportsPlugin</strong></p><p>略过。</p></li><li><p><strong>OccurrenceOrderModuleIdsPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/configuration/optimization/namedModules&amp;moduleIds&amp;occurrenceOrder&amp;hashedModuleIds.html" class="">OccurrenceOrderModuleIdsPlugin</a></p></li><li><p><strong>OccurrenceOrderChunkIdsPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/configuration/optimization/namedChunks&amp;chunkIds&amp;occurrenceOrder.html" class="">OccurrenceOrderChunkIdsPlugin</a></p></li><li><p><strong>DefinePlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/internal-plugins/DefinePlugin.html" class="">DefinePlugin</a></p></li><li><p><strong>TemplatedPathPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/webpack-process/TemplatedPathPlugin.html" class="">TemplatedPathPlugin</a></p></li><li><p><strong>RecordIdsPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/configuration/recordsPath&amp;recordsInputPath&amp;recordsOutputPath.html" class="">RecordIdsPlugin</a></p></li><li><p><strong>WarnCaseSensitiveModulesPlugin</strong></p><p>详细的请👇<a href="/blog-site/webpack4/webpack-process/WarnCaseSensitiveModulesPlugin.html" class="">WarnCaseSensitiveModulesPlugin</a></p></li></ul></li></ul><p><strong>为什么要有 thisCompilation 与 compilation hook 呢，看起来合并成一个 hook 也不是不可以啊？</strong></p><p>在绝大多数情况下肯定是可以的，但是 webpack 的 Compiler 还有另外一种形态，那就是 <a href="/blog-site/webpack4/internal-class/childCompiler.html" class="">childCompiler</a>。childCompiler 不会复制 parentCompiler 上的 thisCompilation hook，也就是不会执行上述的 JsonpTemplatePlugin 等等插件。</p><p>第四步就是触发 make hook，这个 hook 代表构建过程从 entry 配置的文件开始，按照<strong>深度遍历</strong>的顺序逐个解析出所有模块。整个流程的分析可以查询 <a href="/blog-site/webpack4/webpack-process/compiling-modules.html" class="">模块解析</a>这一章节。</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/theniceangel/edit/main/webpack4/webpack-process/compiling.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2021/9/5 下午11:48:37</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: jizhi@didiglobal.com">jizhi</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/blog-site/webpack4/webpack-process/before-compile.html" class="nav-link" aria-label="编译之前"><!--[--><!--]--> 编译之前 <!--[--><!--]--></a></span><span class="next"><a href="/blog-site/webpack4/webpack-process/compiling-modules.html" class="nav-link" aria-label="模块解析"><!--[--><!--]--> 模块解析 <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/blog-site/assets/js/runtime~app.b8391e89.js" defer></script><script src="/blog-site/assets/js/4640.d13a5239.js" defer></script><script src="/blog-site/assets/js/app.20f347e0.js" defer></script>
  </body>
</html>
